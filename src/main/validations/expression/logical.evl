context EXPR!StringComparison {
    constraint Resolved {
        guard: self.left.satisfiesAll("Resolved") and self.right.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
}

context EXPR!EnumerationComparison {
    constraint Resolved {
        guard: self.left.satisfiesAll("Resolved") and self.right.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
}

context EXPR!NegationExpression {
    constraint Resolved {
        guard: self.expression.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
}

context EXPR!KleeneExpression {
    constraint Resolved {
        guard: self.left.satisfiesAll("Resolved") and self.right.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
}

context EXPR!InstanceOfExpression {
    constraint Resolved {
        guard: self.objectExpression.satisfiesAll("Resolved") and self.elementName.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
}

context EXPR!UndefinedAttributeComparison {
    constraint Resolved {
        guard: self.objectExpression.satisfiesAll("Resolved") and self.elementName.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
}

context EXPR!UndefinedNavigationComparison {
    constraint Resolved {
        guard: self.objectExpression.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
}

context EXPR!LogicalAttribute {
    constraint AttributeTypeIsBoolean {
        guard: self.satisfiesAll("Resolved")
        
        check: self.getAttributeType().isBoolean()
        message: "Attribute type of " + self.attributeName + " of object type " + self.objectExpression.getObjectType().getName() + " is not boolean"
    }
}

context EXPR!ContainsExpression {
    constraint Resolved {
        guard: self.collectionExpression.satisfiesAll("Resolved") and self.objectExpression.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
    
    constraint TypesAreCompatible {
        guard: self.satisfiesAll("Resolved")
        
        check: self.collectionExpression.getObjectType() == self.objectExpression.getObjectType()
            or self.collectionExpression.getObjectType().getSuperTypes().contains(self.objectExpression.getObjectType())
            or self.objectExpression.getObjectType().getSuperTypes().contains(self.collectionExpression.getObjectType())
        message: "Types of collection and object are not compatible"  
    }
}

context EXPR!IntegerComparison {
    constraint Resolved {
        guard: self.left.satisfiesAll("Resolved") and self.right.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
}

context EXPR!DecimalComparison {
    constraint Resolved {
        guard: self.left.satisfiesAll("Resolved") and self.right.satisfiesAll("Resolved")
        
        check: true
        message: "Unsupported expression: " + self.toString()
    }
}