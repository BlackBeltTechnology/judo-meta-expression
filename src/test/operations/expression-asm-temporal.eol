@cached
operation ASM!EDataType isDate() : Boolean {
    return "EDate".getDataTypeByName() == self
        or "JDate".getDataTypeByName() == self;
}

@cached
operation ASM!EDataType isTimestamp() : Boolean {
    return "JTimestamp".getDataTypeByName() == self;
}

@cached
operation EXPR!TimestampAdditionExpression hasValidDurationUnit() : Boolean {
    var unit = self.duration.getUnit();
    if (not unit.isDefined() or not unit.isKindOf(MEASURES!DurationUnit)) {
        return false;
    }
    
    return unit.type == MEASURES!DurationType#millisecond
        or unit.type == MEASURES!DurationType#second
        or unit.type == MEASURES!DurationType#minute
        or unit.type == MEASURES!DurationType#hour
        or unit.type == MEASURES!DurationType#day
        or unit.type == MEASURES!DurationType#week;
}
